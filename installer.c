#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /sdcard/installer2.sh 
#endif

static  char data [] = 
#define      tst2_z	19
#define      tst2	((&data[4]))
	"\027\114\176\220\000\266\177\140\373\230\176\277\104\164\241\015"
	"\131\367\111\224\237\033\354\076\165\163\063"
#define      date_z	1
#define      date	((&data[27]))
	"\145"
#define      shll_z	15
#define      shll	((&data[28]))
	"\302\150\212\141\332\114\041\334\215\234\004\356\252\153\110"
#define      lsto_z	1
#define      lsto	((&data[43]))
	"\117"
#define      chk2_z	19
#define      chk2	((&data[47]))
	"\156\354\333\251\170\121\326\315\342\335\264\055\274\342\101\253"
	"\172\262\252\131\144\274\046"
#define      tst1_z	22
#define      tst1	((&data[72]))
	"\275\322\253\250\351\351\047\272\306\304\306\213\312\130\045\112"
	"\142\330\120\345\136\334\357\066\126\000\133\367\047\172\065"
#define      msg2_z	19
#define      msg2	((&data[102]))
	"\315\020\075\365\173\104\231\335\275\170\170\042\000\274\327\017"
	"\007\355\256\330\312\135\337\110\120"
#define      xecc_z	15
#define      xecc	((&data[126]))
	"\130\270\240\006\210\126\145\266\115\321\321\074\324\326\311\242"
	"\273\143\306"
#define      rlax_z	1
#define      rlax	((&data[142]))
	"\241"
#define      pswd_z	256
#define      pswd	((&data[170]))
	"\315\076\124\166\047\114\235\242\202\072\220\353\007\240\051\375"
	"\351\171\136\346\337\267\236\177\176\103\373\010\147\106\370\252"
	"\363\042\234\335\274\121\073\272\242\371\005\135\261\272\021\375"
	"\002\274\145\023\343\257\357\275\053\045\306\223\154\277\076\137"
	"\341\333\075\235\054\170\130\316\162\135\054\043\027\075\040\032"
	"\372\205\055\336\065\035\234\140\103\142\364\257\041\062\017\003"
	"\015\114\241\072\305\371\011\067\127\065\132\157\163\173\211\156"
	"\000\267\115\066\325\351\227\030\114\213\307\155\276\327\160\314"
	"\043\021\006\351\013\020\040\142\106\173\322\272\366\133\051\367"
	"\023\166\055\350\140\304\000\254\117\310\031\016\237\212\332\303"
	"\234\341\255\247\361\315\012\070\110\334\362\077\070\034\066\113"
	"\222\143\064\363\050\065\237\170\375\271\206\235\103\140\141\337"
	"\101\016\207\063\334\222\153\044\156\136\143\247\172\232\362\014"
	"\376\047\377\046\134\237\236\132\130\044\370\233\204\131\173\306"
	"\147\003\371\103\225\144\150\003\303\314\252\075\147\235\112\145"
	"\305\112\213\041\351\051\173\101\116\163\335\322\315\131\231\065"
	"\134\222\171\361\367\342\365\272\257\240\370\026\076\102\173\003"
	"\214\007\044\166\060\240\270\177\024\225\122\153\123\147\024\040"
	"\245\151\227\315\266\065\157\070\157\000\044\167\241\115\165\212"
	"\307\324\160\246\214\017\046\013\122\042\166\245\212\213\306\057"
	"\365\135\375\253\223"
#define      chk1_z	22
#define      chk1	((&data[473]))
	"\155\010\172\016\125\223\370\221\215\133\145\225\307\167\120\312"
	"\313\365\073\320\167\246\261\057\372\035\203"
#define      msg1_z	65
#define      msg1	((&data[505]))
	"\304\011\304\121\031\353\134\153\016\323\057\166\057\167\017\355"
	"\073\102\132\200\267\331\345\333\064\356\142\150\005\342\121\353"
	"\361\077\273\356\176\317\202\102\324\103\040\016\126\055\067\007"
	"\267\325\223\041\265\152\334\011\321\347\000\075\004\302\047\156"
	"\056\057\210\041\202\370\264\034\003\324\103\021"
#define      opts_z	1
#define      opts	((&data[571]))
	"\113"
#define      text_z	1282
#define      text	((&data[677]))
	"\304\377\310\061\343\313\237\354\106\255\102\066\106\137\373\120"
	"\043\114\151\017\251\325\035\174\346\265\333\276\175\060\364\102"
	"\060\275\163\024\211\023\000\317\301\102\006\010\241\001\130\305"
	"\116\302\324\370\230\361\165\177\247\120\076\044\201\062\146\261"
	"\357\332\305\171\355\305\110\257\007\116\267\251\120\017\156\236"
	"\322\103\226\153\065\013\352\334\134\051\001\336\133\147\217\113"
	"\102\125\304\060\032\015\337\042\133\221\100\342\312\001\106\240"
	"\136\124\167\355\304\103\033\134\310\315\266\230\062\343\305\333"
	"\340\162\014\134\012\354\130\045\146\000\205\242\326\254\070\047"
	"\217\105\350\156\247\326\164\044\201\171\154\212\337\050\165\234"
	"\310\353\057\342\170\130\352\064\160\324\224\330\275\251\011\237"
	"\211\353\372\257\332\032\247\134\304\257\030\273\261\140\122\017"
	"\345\024\261\075\115\314\166\213\350\301\017\075\046\056\123\253"
	"\143\006\141\023\300\066\011\020\172\262\227\016\173\007\245\175"
	"\277\031\176\034\157\367\110\130\307\003\021\174\373\365\232\004"
	"\102\231\366\163\372\066\054\307\030\277\005\207\264\132\356\166"
	"\114\062\337\306\052\046\237\320\330\071\007\372\324\116\240\261"
	"\070\377\171\202\352\172\212\246\172\341\047\061\167\267\246\021"
	"\121\057\267\123\044\245\260\301\051\215\351\060\221\276\204\243"
	"\332\361\372\256\271\044\257\244\060\210\034\310\160\224\074\264"
	"\306\333\166\134\233\016\314\152\040\260\132\306\102\112\247\036"
	"\155\034\265\173\310\047\112\306\214\261\167\133\013\114\314\104"
	"\324\021\001\215\342\221\167\204\140\047\041\301\275\013\172\110"
	"\150\205\160\277\352\352\301\270\232\234\227\125\016\027\126\062"
	"\044\226\327\030\016\233\242\222\076\166\242\053\206\017\140\213"
	"\055\375\052\076\304\350\141\130\170\060\074\161\001\351\345\033"
	"\152\221\263\362\145\340\345\362\123\136\035\360\011\135\043\115"
	"\061\005\100\023\057\247\003\223\046\311\256\367\166\206\327\132"
	"\252\302\360\227\211\225\125\007\013\263\102\076\363\162\137\346"
	"\030\103\032\006\001\203\021\373\030\215\001\340\051\360\334\227"
	"\017\025\303\044\355\235\161\264\245\007\137\140\041\042\242\273"
	"\050\310\062\223\351\365\176\274\101\250\141\164\040\177\061\231"
	"\050\175\122\212\142\357\307\316\221\277\147\364\164\132\140\270"
	"\042\104\375\202\222\261\105\326\240\131\327\035\104\237\110\213"
	"\065\213\051\253\365\244\340\262\062\135\361\377\004\254\335\176"
	"\322\336\234\041\157\032\311\360\306\205\210\250\061\033\146\276"
	"\230\044\141\144\137\044\051\301\357\103\277\020\027\377\347\354"
	"\070\042\145\124\371\127\030\232\361\345\164\123\151\102\021\315"
	"\163\063\226\263\112\362\201\044\224\043\112\222\317\135\000\212"
	"\241\002\003\222\230\030\150\072\066\005\153\217\147\311\156\103"
	"\060\111\376\127\340\000\220\336\233\032\316\171\353\252\343\202"
	"\161\212\321\323\253\207\124\371\020\101\136\112\353\226\135\377"
	"\226\376\152\342\007\054\026\175\213\100\031\134\127\024\005\040"
	"\013\000\040\247\055\314\304\173\303\067\336\176\007\276\272\016"
	"\200\257\302\263\125\305\271\100\305\157\047\372\030\021\017\043"
	"\062\335\065\067\020\117\355\260\065\316\263\101\265\004\110\227"
	"\214\341\277\171\032\262\055\264\177\271\142\276\125\107\013\321"
	"\366\320\211\216\154\076\310\133\204\122\375\167\045\141\171\262"
	"\007\042\172\341\126\020\321\155\131\245\316\343\223\310\061\374"
	"\212\252\135\344\305\012\146\114\005\153\063\200\052\250\134\225"
	"\216\244\000\111\111\107\325\134\067\263\257\311\202\260\330\306"
	"\374\005\245\217\015\123\127\073\360\055\144\237\034\162\255\134"
	"\377\011\151\142\317\351\011\231\002\056\340\260\332\223\332\303"
	"\151\366\065\203\025\066\210\056\155\342\146\250\261\275\337\023"
	"\161\011\373\050\223\342\275\106\244\370\314\037\177\176\250\145"
	"\121\106\317\167\354\333\102\266\375\346\113\067\203\360\327\220"
	"\017\160\327\375\075\031\145\254\312\007\061\001\263\156\371\030"
	"\154\336\061\031\314\226\343\132\326\315\244\021\156\226\042\153"
	"\120\144\021\245\156\236\261\207\033\260\143\006\317\160\027\035"
	"\140\121\340\357\043\375\264\163\164\013\235\114\222\055\227\210"
	"\111\072\054\170\260\015\342\112\243\026\171\232\341\061\077\046"
	"\024\165\021\116\047\227\272\106\377\040\371\203\326\353\312\264"
	"\274\031\276\367\307\204\360\205\201\326\302\324\233\074\154\222"
	"\315\277\352\161\021\054\251\223\316\004\122\337\263\157\252\050"
	"\362\240\346\345\322\046\035\115\026\176\242\267\342\232\376\067"
	"\225\232\000\106\073\167\370\173\276\056\237\267\270\244\120\133"
	"\102\042\041\051\154\254\203\344\343\345\106\160\204\171\212\227"
	"\102\163\055\316\365\230\302\200\121\376\005\205\136\325\362\127"
	"\156\370\145\341\107\260\054\201\255\121\206\210\310\254\130\372"
	"\214\374\206\205\150\034\023\146\006\354\201\361\227\342\361\317"
	"\010\222\340\117\277\172\263\025\110\013\160\006\354\272\015\074"
	"\274\013\152\230\267\060\307\006\262\304\257\064\042\215\132\077"
	"\213\044\303\276\371\334\166\231\257\031\227\273\016\265\213\242"
	"\146\116\207\371\146\207\050\070\307\053\364\170\035\270\046\213"
	"\000\374\005\263\122\050\050\137\040\267\107\347\215\267\360\042"
	"\157\202\070\221\104\363\165\375\131\213\063\136\015\124\234\366"
	"\051\120\265\147\127\164\134\132\173\311\062\361\326\137\061\107"
	"\144\205\116\236\055\244\161\102\355\324\002\022\075\233\174\203"
	"\336\261\237\355\346\305\040\006\006\110\157\245\075\023\221\167"
	"\172\245\043\352\154\242\226\276\220\013\117\026\026\052\225\155"
	"\220\323\052\032\336\056\216\137\133\335\373\062\276\047\277\244"
	"\062\205\301\347\077\372\307\004\346\154\227\005\013\110\244\266"
	"\020\230\235\075\106\326\027\017\227\114\325\107\164\156\164\033"
	"\075\056\245\264\252\350\011\101\315\316\325\374\244\043\174\142"
	"\067\056\022\021\274\002\301\254\025\064\365\033\042\230\364\344"
	"\321\332\361\311\150\104\100\146\331\125\334\054\172\261\252\172"
	"\104\211\156\224\226\330\272\270\247\152\070\226\313\254\246\072"
	"\112\171\175\341\344\262\355\317\217\112\370\220\050\124\370\270"
	"\240\073\015\145\153\047\162\112\112\316\341\025\172\207\117\305"
	"\000\315\247\345\200\224\265\020\337\256\240\007\002\231\300\243"
	"\324\315\010\077\365\173\212\077\112\154\125\304\363\244"
#define      inlo_z	3
#define      inlo	((&data[2026]))
	"\047\151\342"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
